<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic HTML Loader</title>
</head>
<body>
    <!-- Dynamischer Inhalt -->
    <div id="6dfc24b9b228c9808d31b7f8afc5a06e892ffccedd9acbcf6c379b30f647882d"></div>
    <script>
        // Einzigartige Hashes f√ºr Elemente und Funktionen
        const uniqueContentId = '6dfc24b9b228c9808d31b7f8afc5a06e892ffccedd9acbcf6c379b30f647882d';
        const floatingContainerId = '0aafa35f7a0f5d6b3b87d76a76328f8d1dbf2565b37f618285e307fbef6cda0c';

        // Funktion zum Einf√ºgen von schwebenden Buttons
        function e699d95ca46dc29080bebbf9a0962f5947e0ce2d5727416aba74b4d177e84c63() {
            // Schwebenden Container erstellen
            const floatingContainer = document.createElement('div');
            floatingContainer.id = floatingContainerId;

            // Shadow DOM erstellen, um Buttons komplett zu isolieren
            const shadowRoot = floatingContainer.attachShadow({ mode: 'open' });

            // HTML und CSS f√ºr die Buttons
            shadowRoot.innerHTML = `
                <style>
                    /* Allgemeine Container-Styles */
                    .container {
                        position: fixed;
                        z-index: 10000;
                        display: flex;
                        gap: 10px;
                    }

                    /* Vertikale Ausrichtung links oder rechts */
                    .vertical {
                        flex-direction: column;
                        top: 20px;
                        height: auto;
                    }

                    /* Horizontale Ausrichtung unten */
                    .horizontal {
                        flex-direction: row;
                        bottom: 20px;
                        left: 50%;
                        transform: translateX(-50%);
                        width: auto;
                    }

                    /* Button-Styles */
                    .button {
                        all: unset;
                        display: inline-block;
                        padding: 10px 15px;
                        font-size: 14px;
                        font-family: Arial, sans-serif;
                        color: #ffffff;
                        background-color: #007bff;
                        border-radius: 5px;
                        cursor: pointer;
                        text-align: center;
                        user-select: none;
                        white-space: nowrap;
                    }

                    .button:hover {
                        background-color: #0056b3;
                    }
                </style>
                <div class="container vertical" id="dc37cfb89630d3df4cec24e8b7384ee53f533e11eea535293496b8a4477a9924">
                    <button class="button" id="b1a5f00fa98f370cf053c6fdcd1346803030f8b4f8cd251938ab91e65da643f2">Drucken</button>
                    <button class="button" id="1cd4a3f79c83f8b7d37e15f53af264c6b58c4c2a9debb7345a6220b919e1931f">In Zwischenablage kopieren</button>
                    <button class="button" id="d13b592361b09496b24cde986d69d3dfe05bbee5213205de5ab9c2e83b074f08">Per E-Mail senden</button>
                    <button class="button" id="72db45e9c4da1edb4f9f66f947c9f9f14275cf181b0e2cd56816c391d8e97e4a">Position wechseln</button>
                </div>
            `;

            // Buttons zum DOM hinzuf√ºgen
            document.body.appendChild(floatingContainer);

            // Referenzen f√ºr Buttons und Container
            const buttonContainer = shadowRoot.getElementById('dc37cfb89630d3df4cec24e8b7384ee53f533e11eea535293496b8a4477a9924');
            const printButton = shadowRoot.getElementById('b1a5f00fa98f370cf053c6fdcd1346803030f8b4f8cd251938ab91e65da643f2');
            const copyButton = shadowRoot.getElementById('1cd4a3f79c83f8b7d37e15f53af264c6b58c4c2a9debb7345a6220b919e1931f');
            const emailButton = shadowRoot.getElementById('d13b592361b09496b24cde986d69d3dfe05bbee5213205de5ab9c2e83b074f08');
            const positionButton = shadowRoot.getElementById('72db45e9c4da1edb4f9f66f947c9f9f14275cf181b0e2cd56816c391d8e97e4a');

            // Positionslogik
            const positions = [
                { class: 'vertical', style: 'left: 20px;' },   // Vertikal links
                { class: 'horizontal', style: '' },           // Horizontal unten
                { class: 'vertical', style: 'right: 20px;' }  // Vertikal rechts
            ];
            let currentPosition = 0;

            const updatePosition = () => {
                const { class: positionClass, style } = positions[currentPosition];
                buttonContainer.className = `container ${positionClass}`;
                buttonContainer.style.cssText = style;
            };

            positionButton.addEventListener('click', () => {
                currentPosition = (currentPosition + 1) % positions.length;
                updatePosition();
            });

            // Initiale Position festlegen
            updatePosition();

            // Druck-Funktion
            printButton.addEventListener('click', () => {
                const contentDiv = document.getElementById(uniqueContentId);
                const printWindow = window.open("", "_blank");

                printWindow.document.open();
                printWindow.document.write(`
                    <!DOCTYPE html>
                    <html lang="de">
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        <title>üñ®</title>
                        <style>
                            body {
                                font-family: Arial, sans-serif;
                                margin: 2cm;
                            }
                        </style>
                    </head>
                    <body>${contentDiv.innerHTML}</body>
                    </html>
                `);
                printWindow.document.close();
                printWindow.onload = () => {
                    printWindow.focus();
                    printWindow.print();
                    printWindow.close();
                };
            });

            // Zwischenablage-Funktion
            copyButton.addEventListener('click', () => {
                const contentDiv = document.getElementById(uniqueContentId);
                const textToCopy = contentDiv.innerText || contentDiv.textContent;

                navigator.clipboard.writeText(textToCopy)
                    .then(() => alert("Der Inhalt wurde erfolgreich in die Zwischenablage kopiert!"))
                    .catch((err) => alert("Fehler beim Kopieren: " + err));
            });
			
			// Per E-Mail senden-Funktion
            emailButton.addEventListener('click', () => {
                const contentDiv = document.getElementById(uniqueContentId);
                const textToCopy = contentDiv.innerText || contentDiv.textContent;

                const firstLine = textToCopy.split('\n')[0];
                const currentDate = new Date();
                const formattedDate = currentDate.toLocaleString('de-DE', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });

				// Zwischenablage kopieren
				navigator.clipboard.writeText(textToCopy)
					.then(() => {
						// Mailto-Link mit erster Zeile und Datum im Betreff und vollst√§ndigem Text im Body
						const mailtoLink = `mailto:?subject=${encodeURIComponent(firstLine + ' - ' + formattedDate)}&body=${encodeURIComponent(textToCopy)}`;
						window.location.href = mailtoLink;
					})
					.catch((err) => alert("Fehler beim Kopieren: " + err));
			});

			
        }

        // Dynamischen Inhalt laden und Buttons hinzuf√ºgen
        (function () {
            const currentUrl = window.location.href;
            const htmlContent = currentUrl.split('.html?&=')[1];
            const contentDiv = document.getElementById(uniqueContentId);

            // Skripte innerhalb des geladenen Inhalts ausf√ºhren
            function executeScripts(container) {
                const scripts = container.querySelectorAll("script");
                scripts.forEach((script) => {
                    const newScript = document.createElement("script");
                    if (script.src) {
                        newScript.src = script.src;
                        newScript.async = false;
                    } else {
                        newScript.textContent = script.textContent;
                    }
                    document.body.appendChild(newScript);
                    script.remove();
                });
            }

            if (htmlContent) {
                try {
                    const decodedHtml = decodeURIComponent(htmlContent);
                    contentDiv.innerHTML = decodedHtml;
                    executeScripts(contentDiv);
                } catch (e) {
                    document.body.innerHTML += '<p style="color: red;">Fehler beim Dekodieren der URL. M√∂glicherweise enth√§lt die URL ung√ºltige Zeichen.</p>';
                }
            } else {
                document.body.innerHTML += '<p style="color: red;">Kein g√ºltiger HTML-Inhalt in der URL gefunden. Bitte die URL in der Form ".html?&lt;html-code&gt;" aufrufen.</p>';
            }

            // Buttons hinzuf√ºgen
            e699d95ca46dc29080bebbf9a0962f5947e0ce2d5727416aba74b4d177e84c63();
        })();
    </script>
</body>
</html>
